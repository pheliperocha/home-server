apiVersion: k8up.io/v1
kind: Restore
metadata:
  name: manual-restore
  namespace: home-server
spec:
  # restic snapshots --latest 1
  snapshot: SNAPSHOT_ID
  restoreMethod:
    folder:
      # kubectl get pvc -n home-server
      claimName: PVC_NAME
  podSecurityContext:
    runAsUser: 0

  ## AWS S3 as backend for backups
  backend:
    s3:
      endpoint: https://s3.sa-east-1.amazonaws.com
      bucket: home-server-backups
      accessKeyIDSecretRef:
        name: k8up-secrets
        key: AWS_ACCESS_KEY_ID
      secretAccessKeySecretRef:
        name: k8up-secrets
        key: AWS_SECRET_ACCESS_KEY
    repoPasswordSecretRef:
      name: k8up-secrets
      key: RESTIC_REPOSITORY_PASSWORD

  ## Minio as backend for backups
  # backend:
  #   s3:
  #     endpoint: http://home-server-minio.home-server:9000
  #     bucket: backups
  #     accessKeyIDSecretRef:
  #       name: home-server-minio
  #       key: root-user
  #     secretAccessKeySecretRef:
  #       name: home-server-minio
  #       key: root-password
  #   repoPasswordSecretRef:
  #     name: k8up-secrets
  #     key: RESTIC_REPOSITORY_PASSWORD